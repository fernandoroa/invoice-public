---
title: "Invoice"
output: pdf_document
geometry: "left=3cm,right=2cm,top=0cm,bottom=2cm"
fontsize: 11pt
papersize: a4
header-includes:
  - \usepackage{comment}
params: 
  inv_date: NA
  start_date: NA
  end_date: NA
  invoiceNumber: '2022-'
  exchangeRate: 4.1683
---
```{r setup, message = F,echo=F,warning=F}
library(lubridate)
library(readr)
library(dplyr)
ed <-  ymd(params$end_date)
sm <- month(params$start_date,label = T)
em <- month(params$end_date,label = T)
sdt <- day(params$start_date)
edt <- day(params$end_date)
sy <- year(params$start_date)
ey <- year(params$end_date)

inv_dt <- day(params$inv_date)
inv_m <- month(params$inv_date, label = T)
inv_y <- year(params$inv_date)

jsonSalaryL <- rjson::fromJSON(file = "input_salary.json")

condition<- jsonSalaryL$originalCurrency==jsonSalaryL$finalCurrency

exchange <- ifelse( condition
                    ,""
                    ,paste(jsonSalaryL$originalSalary,jsonSalaryL$originalCurrency
                            ,"/",params$exchangeRate
                            , "=")
)

result <- ifelse(condition,jsonSalaryL$originalSalary
                 , round(jsonSalaryL$originalSalary/params$exchangeRate )
)

benefits <- ifelse(condition
                   ,jsonSalaryL$originalBenefits
                 , round(jsonSalaryL$originalBenefits/params$exchangeRate )
)

total <- result+benefits

result <- format(result, scientific = F)

total <- format(total, scientific = F)

# Give the input file name to the function.
jsonL <- rjson::fromJSON(file = "input.json")
```

\pagenumbering{gobble} 

\raggedright Invoice Number: `r params$invoiceNumber` \par

\raggedleft Consultant Business:  `r jsonL$consultantBusiness`    
\raggedleft `r jsonL$consultantAddress1`  
\raggedleft `r jsonL$consultantAddress2`   
\raggedleft `r jsonL$consultantAddress3`   
\raggedleft `r jsonL$consultantCountry`    
\raggedleft Contact No:  `r jsonL$consultantPhone` 

\raggedright Bill To, \par  
 
`r jsonL$billTo1`  
`r jsonL$billTo2`  
`r jsonL$billTo3`  
`r jsonL$billTo4`  
`r jsonL$billTo5`  

\begin{flushright} 
Date:  `r inv_dt` `r inv_m` `r inv_y`  
\end{flushright} 

|Services                |AMOUNT    |
|------------------------|-----------
|Consultancy Charges     |                                         | 
|\hspace{2mm} `r  sdt` `r sm` `r sy` to `r edt` `r em` `r ey` |                |
|\hspace{2mm} 1 month: `r exchange`  | `r result`   `r jsonSalaryL$finalCurrency`   |
|Benefits                | `r benefits` `r jsonSalaryL$finalCurrency`   |            
| **TOTAL**              | **`r total` `r jsonSalaryL$finalCurrency`** |


\begin{flushright} 
Signature
\end{flushright}

\Large  \textbf{Wire Instructions} / \normalsize Bank Account Information

``` {r , results="asis", echo=F, eval=jsonSalaryL$intermediaryBank} 
cat("\\large \\textbf{Intermediary} / Correspondent Bank \\textbf{(Field 56):}  \n  ")
cat(paste0("\\hspace{5mm} \\normalsize SWIFT: **",jsonL$intermediary_bank_swift,"**  \n") )    
cat(paste0("\\hspace{5mm} Name:",    jsonL$intermediary_bank_name,"  \n")  )
cat(paste0("\\hspace{5mm} Country:", jsonL$intermediary_bank_country,"  \n") )  
```

\large Beneficiary \textbf{Bank (Field 57):}  
\normalsize \hspace{5mm} SWIFT: \textbf{`r jsonL$final_bank_swift`}  
``` {r , results="asis", echo=F, eval=T} 
if(jsonSalaryL$intermediaryBank){
  cat(paste("\\hspace{5mm}", paste0("**",jsonL$final_bank_short_name," Account** with") ,jsonL$intermediary_bank_name,":",paste0("**",jsonL$final_bank_account,"**  \n") ) )
} else {
  cat("<!-- some -->")
}
```
\hspace{5mm} Name: \textbf{`r jsonL$final_bank_name`}  
\hspace{5mm} Address: `r jsonL$final_bank_address`  
\hspace{5mm} Country: `r jsonL$final_bank_country`  

\large \textbf{Consultant} Business / Beneficiary Customer \textbf{(Field 59)}:  
\hspace{5mm} \normalsize Name: `r jsonL$consultantBusiness`    
\hspace{5mm} IBAN: **`r jsonL$consultantIBAN`**  
\hspace{5mm} Address: `r paste0(jsonL$consultantAddress1,", ",jsonL$consultantAddress2,", ",jsonL$consultantAddress3)`  
\hspace{5mm} Country: `r jsonL$consultantCountry`  

\large Remittance Information \textbf{(Field 70)}:  
\hspace{5mm} \normalsize Include also **invoice number**, **contract number**
